import{u as b,Q as j}from"./useBaseQuery-CGPKQZvt.js";import{j as t,r as v,A as S}from"./index-CJ33uSs8.js";import{u,c as I,z as o,S as F,B as w,a as N,b as R,F as T,T as p}from"./zod-DPXgnS-f.js";import{c as C}from"./createLucideIcon-DmVWskca.js";function O(e,n){return b(e,j)}/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],A=C("trash",k);function P({name:e,control:n,...i}){const{field:a,fieldState:s}=u({name:e,control:n});return t.jsx(I,{...a,className:"resize-none",...i,error:s.error?.message})}function E(e){try{return new URL(e),!0}catch{return!1}}const L=o.object({title:o.string().min(1,{error:"Field cannot be empty"}),description:o.string().min(1,{error:"Field cannot be empty"}),price:o.coerce.number().int().min(1).max(9999),categoryId:o.number().int().min(1),images:o.array(o.string()).superRefine((e,n)=>{(e.filter(a=>!E(a)).length>0||!e.length)&&n.addIssue({code:"custom",message:"One or more valid URLs is required",path:[]})})});function U({name:e,options:n,control:i,...a}){const{field:s,fieldState:l}=u({name:e,control:i});return t.jsx(F,{options:n,...s,...a,error:l.error?.message})}function V({name:e,label:n,control:i,...a}){const[s,l]=v.useState(""),{field:{value:c=[],onChange:m,...d},fieldState:f}=u({name:e,control:i}),h=()=>{const r=s.trim();r&&!c.includes(r)&&(m([...c,r]),l(""))},g=r=>{m(c.filter(y=>y!==r))},x=r=>{r.key==="Enter"&&(r.preventDefault(),h())};return t.jsxs("div",{children:[t.jsx(w,{...a,...d,value:s,onChange:r=>l(r.target.value),onKeyDown:x,label:n,error:f.error?.message}),t.jsx("h4",{children:"URLs list:"}),t.jsx("ul",{className:"mt-2",children:c?.map(r=>t.jsxs("li",{className:"w-full flex text-sm bg-[var(--light-bg)] rounded-full px-3 py-2 items-center justify-between gap-4 mb-4",children:[t.jsx("span",{className:"w-full truncate",children:r}),t.jsx("button",{type:"button",className:"hover:cursor-pointer hover:text-amber-500 ",onClick:()=>g(r),children:t.jsx(A,{className:"size-4"})})]},r))})]})}const Q=({product:e,categories:n})=>{const{handleSubmit:i,setError:a,control:s,formState:{isSubmitting:l}}=N({defaultValues:{title:e?.title||"",price:e?.price||1,categoryId:e?.categoryId||1,description:e?.description||"",images:e?.images||[]},resolver:R(L)}),c=async m=>{(await fetch(S+"/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok||a("root",{message:"You could not be authorized"})};return t.jsxs(T,{onSubmit:i(c),isSubmitting:l,children:[t.jsx(p,{label:"Title",name:"title",control:s}),t.jsx(p,{label:"Price",name:"price",control:s}),t.jsx(P,{label:"Description",name:"description",control:s,rows:7}),t.jsx(U,{label:"Category",name:"categoryId",control:s,options:n}),t.jsx(V,{label:"Images",name:"images",control:s})]})};export{Q as P,O as u};
