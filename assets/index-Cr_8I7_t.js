import{e as Q,f as B,r as s,g as J,j as e,L as C,A as K}from"./index-DAiz0CAH.js";import{u as V}from"./useQuery-HPyegmto.js";import{u as G,T as W}from"./trash-CFemfFUP.js";import{B as N,S as X,C as L}from"./select-input-D1r--hoW.js";import{c as b}from"./createLucideIcon-Cg4CVqgd.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Z=b("chevron-left",Y);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],te=b("chevron-right",ee);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],M=b("chevron-up",se);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],re=b("plus",ae);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["path",{d:"M13 16H8",key:"wsln4y"}],["path",{d:"M14 8H8",key:"1l3xfs"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"M4 3a1 1 0 0 1 1-1 1.3 1.3 0 0 1 .7.2l.933.6a1.3 1.3 0 0 0 1.4 0l.934-.6a1.3 1.3 0 0 1 1.4 0l.933.6a1.3 1.3 0 0 0 1.4 0l.933-.6a1.3 1.3 0 0 1 1.4 0l.934.6a1.3 1.3 0 0 0 1.4 0l.933-.6A1.3 1.3 0 0 1 19 2a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1 1.3 1.3 0 0 1-.7-.2l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.934.6a1.3 1.3 0 0 1-1.4 0l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-1.4 0l-.934-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-.7.2 1 1 0 0 1-1-1z",key:"ycz6yz"}]],ne=b("receipt-text",le);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],oe=b("settings",ie),ce=async i=>(await Q.delete("/products/"+i)).data,R="productsListURLParams";function de(i={}){const[a]=B(),g=Object.fromEntries(a.entries());let d={};try{const o=sessionStorage.getItem(R);o&&(d=JSON.parse(o))}catch{d={}}const[u,x]=s.useState(()=>({...i,...d,...g}));function r(o,l){x(m=>{const n={...m};l?n[o]=l:delete n[o];const h=new URLSearchParams(n),c=h.toString()?`?${h.toString()}`:"",p=(window.location.hash||"#/").split("?")[0],S=window.location.pathname+window.location.search+"#"+p.replace(/^#/,"")+c;return window.history.replaceState({},"",S),n})}return s.useEffect(()=>{sessionStorage.setItem(R,JSON.stringify(u))},[u]),s.useEffect(()=>{const o=new URLSearchParams(u);if(!(window.location.search.includes("=")||window.location.hash.includes("?"))&&Object.keys(u).length>0){const m=o.toString()?`?${o.toString()}`:"",h=(window.location.hash||"#/").split("?")[0],c=window.location.pathname+window.location.search+"#"+h.replace(/^#/,"")+m;window.history.replaceState({},"",c)}},[]),{urlState:u,setURLParam:r}}const ue=[{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],be=()=>{const{urlState:i,setURLParam:a}=de(),[g,d]=s.useState(null),[u,x]=s.useState(!1),[r,o]=s.useState(i.limit||10),[l,m]=s.useState(i.offset||0),[n,h]=s.useState(null),[c,w]=s.useState(null),[p,S]=s.useState(i.title||""),[y,_]=s.useState(i.category||""),[j,U]=s.useState(String(i.minPrice)||""),[v,F]=s.useState(String(i.maxPrice)||""),T=J();function $(){w(t=>t===null?"asc":t==="asc"?"desc":null)}function I(){w(null),h(t=>t===null?"asc":t==="asc"?"desc":null)}const{data:P}=V({queryKey:["products",r,l],placeholderData:t=>t,queryFn:async()=>await(await fetch(K+`/products?offset=${l}&limit=${r}`)).json()}),k=s.useMemo(()=>P?P.filter(t=>{const f=p?t.title.toLowerCase().includes(p.toLowerCase()):!0,H=j?Number(t.price)>=Number(j):!0,E=v?Number(t.price)<=Number(v):!0,q=y?t.category.name.toLowerCase().includes(y.toLowerCase()):!0;return f&&H&&E&&q}).sort((t,f)=>n==="asc"?t.title.localeCompare(f.title,"pl",{sensitivity:"base"}):n==="desc"?f.title.localeCompare(t.title,"pl",{sensitivity:"base"}):c==="asc"?t.price-f.price:c==="desc"?f.price-t.price:0):[],[P,p,j,v,y,n,c]),{mutate:z}=G({mutationFn:ce,onSuccess:()=>{d(null),x(!1),T.invalidateQueries({queryKey:["products",r,l]})}}),A=t=>{d(t),x(!0)},D=()=>{d(null),x(!1)},O=()=>{g!==null&&z(g)};return e.jsxs("section",{children:[e.jsx("div",{className:"flex justify-end mb-8",children:e.jsxs(C,{to:"new",className:"bg-gray-200 flex items-center gap-2 px-3 py-1 text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:[e.jsx(re,{}),"Add new"]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-6 font-bold text-amber-500",children:"Filters:"}),e.jsxs("div",{className:"block md:flex gap-2 mb-6",children:[e.jsx(N,{label:"Title",value:p,onChange:t=>{S(t.target.value),a("title",t.target.value)}}),e.jsx(N,{label:"Category",value:y,onChange:t=>{_(t.target.value),a("category",t.target.value)}}),e.jsx(N,{label:"Min price",value:j,onChange:t=>{U(t.target.value),a("minPrice",Number(t.target.value))}}),e.jsx(N,{label:"Max price",value:v,onChange:t=>{F(t.target.value),a("maxPrice",Number(t.target.value))}}),e.jsx(X,{label:"Results per page",options:ue,value:r,onChange:t=>{o(Number(t.target.value)),m(0),a("limit",Number(t.target.value)),a("offset",0)}})]}),e.jsx("div",{})]}),e.jsx("div",{className:"shadow-2xl rounded-2xl bg-[var(--dark-bg)] p-6 mb-6",children:e.jsxs("table",{className:"table-fixed w-full text-left border-separate border-spacing-y-3",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"text-center text-amber-500",children:[e.jsx("th",{className:"p-2 pb-4 w-[70px]",children:"Image"}),e.jsx("th",{onClick:I,className:"p-2 pb-4",children:e.jsxs("p",{className:"flex items-center justify-center",children:["Title ",n==="asc"?e.jsx(M,{}):n==="desc"?e.jsx(L,{}):""]})}),e.jsx("th",{className:"p-2 pb-4 text-center w-[120px]",children:"Category"}),e.jsx("th",{onClick:$,className:"p-2 pb-4 w-[100px]",children:e.jsxs("p",{className:"flex items-center justify-center",children:["Price ",c==="asc"?e.jsx(M,{}):c==="desc"?e.jsx(L,{}):""]})}),e.jsx("th",{className:"w-[10px]"}),e.jsx("th",{className:"p-2 pb-4 w-[120px] text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"mt-8",children:k.map(t=>e.jsxs("tr",{className:"bg-[var(--light-bg)]",children:[e.jsx("td",{className:"p-2 mb-8 rounded-l-2xl",children:e.jsx("img",{className:"mr-8 rounded-xl size-full",src:t?.images?.[0],alt:t?.title})}),e.jsx("td",{className:"p-2 w-full",children:t?.title}),e.jsx("td",{className:"p-2 w-full text-center",children:t?.category.name}),e.jsxs("td",{className:"p-2 text-center rounded-r-2xl",children:[t?.price,"$"]}),e.jsx("td",{className:"bg-[var(--dark-bg)]"}),e.jsx("td",{className:"p-2 text-center rounded-2xl",children:e.jsxs("div",{className:"flex h-full items-center justify-evenly",children:[e.jsx(C,{className:" color-gray-200 p-1 rounded-full transition-all font-semibold hover:text-amber-500 transition active:scale-95",to:`/products/${t?.id}`,children:e.jsx(ne,{className:"size-5"})}),e.jsx(C,{className:" color-gray-200 p-1 rounded-full transition-all font-semibold hover:text-amber-500 transition active:scale-95",to:`/products/${t?.id}/edit`,children:e.jsx(oe,{className:"size-5"})}),e.jsx(W,{onClick:()=>A(t.id),className:"color-gray-200 size-5 cursor-pointer  rounded-full transition-all  hover:text-amber-500 transition active:scale-95",to:`/products/${t?.id}/edit`})]})})]},t?.id))})]})}),e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("button",{onClick:()=>{const t=l-r;m(()=>t),a("offset",t)},disabled:l===0,className:"flex h-fit disabled:cursor-auto disabled:opacity-25 disabled:pointer-events-none justify-between items-center bg-gray-200 px-2 py-1 text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:[e.jsx(Z,{})," Previous page "]}),e.jsxs("p",{className:"text-gray-300",children:["Page: ",(l+r)/r]}),e.jsxs("button",{onClick:()=>{const t=l+r;m(()=>t),a("offset",t)},disabled:k.length<r,className:"flex h-fit disabled:cursor-auto disabled:opacity-25 disabled:pointer-events-none cursor-pointer justify-bwtween items-center bg-gray-200 px-2 py-1 text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:["Next page ",e.jsx(te,{})]})]}),u&&e.jsx("div",{onClick:()=>{x(!1)},className:"fixed top-0 left-0 size-full z-9999 transition-opacity duration-300 flex justify-center items-center bg-black/30 backdrop-blur-sm",children:e.jsxs("div",{onClick:t=>t.stopPropagation(),className:"rounded-2xl shadow-2xl bg-[var(--dark-bg)] text-center p-8",children:[e.jsx("h3",{className:"my-8 font-bold text-2xl text-amber-500",children:"Are you sure?"}),e.jsx("p",{className:"mb-12",children:"This action is irreversible."}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:D,className:"border border-gray-200 px-2 py-1 cursor-pointer text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-200 hover:border-amber-500 hover:text-amber-500 transition active:scale-95",children:"Close"}),e.jsx("button",{onClick:O,className:"bg-gray-200 px-2 py-1 cursor-pointer text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 text-gray-200 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:"Delete"})]})]})})]})};export{be as default};
