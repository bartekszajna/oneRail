import{j as e,L as R,e as Z,r as u,f as ee,Q as T,S as f,g as te,h as L,U as S,i as se}from"./index-DYuqXGVB.js";import{B as H,S as ae,C as D}from"./select-input-DAMwhWjz.js";import{c as P}from"./createLucideIcon-BImb0yJG.js";import{T as re,u as le}from"./trash-CyTtKI0s.js";import{u as ne}from"./useQuery-DDl6itAX.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],oe=P("chevron-left",ie);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],de=P("chevron-right",ce);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],U=P("chevron-up",ue);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],xe=P("plus",me);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M13 16H8",key:"wsln4y"}],["path",{d:"M14 8H8",key:"1l3xfs"}],["path",{d:"M16 12H8",key:"1fr5h0"}],["path",{d:"M4 3a1 1 0 0 1 1-1 1.3 1.3 0 0 1 .7.2l.933.6a1.3 1.3 0 0 0 1.4 0l.934-.6a1.3 1.3 0 0 1 1.4 0l.933.6a1.3 1.3 0 0 0 1.4 0l.933-.6a1.3 1.3 0 0 1 1.4 0l.934.6a1.3 1.3 0 0 0 1.4 0l.933-.6A1.3 1.3 0 0 1 19 2a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1 1.3 1.3 0 0 1-.7-.2l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.934.6a1.3 1.3 0 0 1-1.4 0l-.933-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-1.4 0l-.934-.6a1.3 1.3 0 0 0-1.4 0l-.933.6a1.3 1.3 0 0 1-.7.2 1 1 0 0 1-1-1z",key:"ycz6yz"}]],pe=P("receipt-text",he);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],fe=P("settings",be),ge=({children:a,isOpen:s,confirmHandler:r,cancelHandler:l})=>s&&e.jsx("div",{onClick:l,className:"fixed top-0 left-0 size-full z-9999 transition-opacity duration-300 flex justify-center items-center bg-black/30 backdrop-blur-sm",children:e.jsxs("div",{onClick:n=>n.stopPropagation(),className:"rounded-2xl shadow-2xl bg-[var(--dark-bg)] text-center p-8",children:[a,e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:l,className:"border border-gray-200 px-2 py-1 cursor-pointer text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-200 hover:border-amber-500 hover:text-amber-500 transition active:scale-95",children:"Close"}),e.jsx("button",{onClick:r,className:"bg-gray-200 px-2 py-1 cursor-pointer text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 text-gray-200 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:"Delete"})]})]})}),ye=[{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],je=({data:a,limit:s,offset:r,titleSort:l,priceSort:n,titleFilter:g,categoryFilter:m,minPriceFilter:i,maxPriceFilter:o,titleFilterHandler:h,categoryFilterHandler:c,minPriceFilterHandler:p,maxPriceFilterHandler:x,limitSelectHandler:v,previousPageHandler:b,nextPageHandler:N,deleteProductHandler:y,titleSortHandler:F,priceSortHandler:j})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-6 font-bold text-amber-500",children:"Filters:"}),e.jsxs("div",{className:"block md:flex gap-2 mb-6",children:[e.jsx(H,{label:"Title",value:g,onChange:h}),e.jsx(H,{label:"Category",value:m,onChange:c}),e.jsx(H,{label:"Min price",value:i,onChange:p}),e.jsx(H,{label:"Max price",value:o,onChange:x}),e.jsx(ae,{label:"Results per page",options:ye,value:s,onChange:v})]})]}),e.jsx("div",{className:"shadow-2xl rounded-2xl bg-[var(--dark-bg)] p-6 mb-6",children:e.jsxs("table",{className:"table-fixed w-full text-left border-separate border-spacing-y-3",children:[e.jsx("thead",{className:"",children:e.jsxs("tr",{className:"text-center text-amber-500",children:[e.jsx("th",{className:"p-2 pb-4 w-[70px]",children:"Image"}),e.jsx("th",{onClick:F,className:"p-2 pb-4",children:e.jsxs("p",{className:"flex items-center justify-center",children:["Title ",l==="asc"?e.jsx(U,{}):l==="desc"?e.jsx(D,{}):""]})}),e.jsx("th",{className:"p-2 pb-4 text-center w-[120px]",children:"Category"}),e.jsx("th",{onClick:j,className:"p-2 pb-4 w-[100px]",children:e.jsxs("p",{className:"flex items-center justify-center",children:["Price ",n==="asc"?e.jsx(U,{}):n==="desc"?e.jsx(D,{}):""]})}),e.jsx("th",{className:"w-[10px]"}),e.jsx("th",{className:"p-2 pb-4 w-[120px] text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"mt-8",children:a.map(d=>e.jsxs("tr",{className:"bg-[var(--light-bg)]",children:[e.jsx("td",{className:"p-2 mb-8 rounded-l-2xl",children:e.jsx("img",{className:"mr-8 rounded-xl size-full",src:d?.images?.[0],alt:d?.title})}),e.jsx("td",{className:"p-2 w-full",children:d?.title}),e.jsx("td",{className:"p-2 w-full text-center",children:d?.category.name}),e.jsxs("td",{className:"p-2 text-center rounded-r-2xl",children:[d?.price,"$"]}),e.jsx("td",{className:"bg-[var(--dark-bg)]"}),e.jsx("td",{className:"p-2 text-center rounded-2xl",children:e.jsxs("div",{className:"flex h-full items-center justify-evenly",children:[e.jsx(R,{className:" color-gray-200 p-1 rounded-full transition-all font-semibold hover:text-amber-500 transition active:scale-95",to:`/products/${d?.id}`,children:e.jsx(pe,{className:"size-5"})}),e.jsx(R,{className:" color-gray-200 p-1 rounded-full transition-all font-semibold hover:text-amber-500 transition active:scale-95",to:`/products/${d?.id}/edit`,children:e.jsx(fe,{className:"size-5"})}),e.jsx(re,{onClick:()=>y(d.id),className:"color-gray-200 size-5 cursor-pointer  rounded-full transition-all  hover:text-amber-500 transition active:scale-95",to:`/products/${d?.id}/edit`})]})})]},d?.id))})]})}),e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("button",{onClick:b,disabled:r===0,className:"flex h-fit disabled:cursor-auto disabled:opacity-25 disabled:pointer-events-none justify-between items-center bg-gray-200 px-2 py-1 text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:[e.jsx(oe,{})," Previous page "]}),e.jsxs("p",{className:"text-gray-300",children:["Page: ",(r+s)/s]}),e.jsxs("button",{onClick:N,disabled:a.length<s,className:"flex h-fit disabled:cursor-auto disabled:opacity-25 disabled:pointer-events-none cursor-pointer justify-bwtween items-center bg-gray-200 px-2 py-1 text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:["Next page ",e.jsx(de,{})]})]})]}),Se=async a=>(await Z.delete("/products/"+a)).data;function ve(a={}){const[s]=te();let r=Object.fromEntries(s.entries());r={...r,...r.offset&&{offset:Number(r.offset)},...r.limit&&{limit:Number(r.limit)}};let l={};try{const i=sessionStorage.getItem(L.PRODUCTS_LIST_URL_PARAMS);i&&(l=JSON.parse(i))}catch{l={}}const[n,g]=u.useState(()=>({...a,...l,...r}));function m(i,o){g(h=>{const c={...h};o?c[i]=o:delete c[i];const p=new URLSearchParams(c),x=p.toString()?`?${p.toString()}`:"",b=(window.location.hash||"#/").split("?")[0],N=window.location.pathname+window.location.search+"#"+b.replace(/^#/,"")+x;return window.history.replaceState({},"",N),c})}return u.useEffect(()=>{sessionStorage.setItem(L.PRODUCTS_LIST_URL_PARAMS,JSON.stringify(n))},[n]),u.useEffect(()=>{const i=new URLSearchParams(n);if(!(window.location.search.includes("=")||window.location.hash.includes("?"))&&Object.keys(n).length>0){const h=i.toString()?`?${i.toString()}`:"",p=(window.location.hash||"#/").split("?")[0],x=window.location.pathname+window.location.search+"#"+p.replace(/^#/,"")+h;window.history.replaceState({},"",x)}},[n]),{urlState:n,setURLParam:m}}const Ne=()=>{const{urlState:a,setURLParam:s}=ve(),[r,l]=u.useState(null),[n,g]=u.useState(!1),[m,i]=u.useState(a.limit||10),[o,h]=u.useState(a.offset||0),[c,p]=u.useState(null),[x,v]=u.useState(null),[b,N]=u.useState(a.title||""),[y,F]=u.useState(a.category||""),[j,d]=u.useState(a.minPrice||""),[w,k]=u.useState(a.maxPrice||""),_=ee();function I(){v(t=>t===null?f.ASC:t===f.ASC?f.DESC:null)}function E(){v(null),p(t=>t===null?f.ASC:t===f.ASC?f.DESC:null)}const{mutate:O}=le({mutationFn:Se,onSuccess:()=>{l(null),g(!1),_.invalidateQueries({queryKey:[T.PRODUCTS,{limit:m,offset:o}]})}}),A=t=>{N(t.target.value),s(S.TITLE,t.target.value)},z=t=>{F(t.target.value),s(S.CATEGORY,t.target.value)},$=t=>{d(t.target.value),s(S.MIN_PRICE,Number(t.target.value))},Q=t=>{k(t.target.value),s(S.MAX_PRICE,Number(t.target.value))},q=t=>{i(Number(t.target.value)),h(0),s(S.LIMIT,Number(t.target.value)),s(S.OFFSET,0)},K=()=>{const t=o-m;h(()=>t),s(S.OFFSET,t)},V=()=>{const t=o+m;h(()=>t),s(S.OFFSET,t)},Y=t=>{l(t),g(!0)},B=()=>{l(null),g(!1)},G=()=>{r!==null&&O(r)},{data:M}=ne({queryKey:[T.PRODUCTS,{limit:m,offset:o}],placeholderData:t=>t,queryFn:()=>se(m,o)});return{data:u.useMemo(()=>M?M.filter(t=>{const C=b?t.title.toLowerCase().includes(b.toLowerCase()):!0,J=j?Number(t.price)>=Number(j):!0,X=w?Number(t.price)<=Number(w):!0,W=y?t.category.name.toLowerCase().includes(y.toLowerCase()):!0;return C&&J&&X&&W}).sort((t,C)=>c===f.ASC?t.title.localeCompare(C.title,"pl",{sensitivity:"base"}):c===f.DESC?C.title.localeCompare(t.title,"pl",{sensitivity:"base"}):x===f.ASC?t.price-C.price:x===f.DESC?C.price-t.price:0):[],[M,b,j,w,y,c,x]),modalVisible:n,limit:m,offset:o,titleSort:c,priceSort:x,titleFilter:b,categoryFilter:y,minPriceFilter:j,maxPriceFilter:w,titleFilterHandler:A,categoryFilterHandler:z,minPriceFilterHandler:$,maxPriceFilterHandler:Q,limitSelectHandler:q,nextPageHandler:V,previousPageHandler:K,openDeleteModalHandler:Y,closeDeleteModalHandler:B,productDeleteHandler:G,priceSortHandler:I,titleSortHandler:E}},Me=()=>{const{data:a,modalVisible:s,limit:r,offset:l,titleSort:n,priceSort:g,titleFilter:m,categoryFilter:i,minPriceFilter:o,maxPriceFilter:h,titleFilterHandler:c,categoryFilterHandler:p,minPriceFilterHandler:x,maxPriceFilterHandler:v,limitSelectHandler:b,previousPageHandler:N,nextPageHandler:y,openDeleteModalHandler:F,closeDeleteModalHandler:j,productDeleteHandler:d,titleSortHandler:w,priceSortHandler:k}=Ne();return e.jsxs("section",{children:[e.jsx("div",{className:"flex justify-end mb-8",children:e.jsxs(R,{to:"new",className:"bg-gray-200 flex items-center gap-2 px-3 py-1 text-xs md:px-4 md:py-2 rounded-full transition-all font-semibold text-gray-900 hover:bg-amber-500 hover:text-gray-200 transition active:scale-95",children:[e.jsx(xe,{}),"Add new"]})}),e.jsx(je,{data:a,limit:r,offset:l,titleSort:n,priceSort:g,titleFilter:m,categoryFilter:i,minPriceFilter:o,maxPriceFilter:h,titleFilterHandler:c,categoryFilterHandler:p,minPriceFilterHandler:x,maxPriceFilterHandler:v,limitSelectHandler:b,previousPageHandler:N,nextPageHandler:y,deleteProductHandler:F,titleSortHandler:w,priceSortHandler:k}),e.jsxs(ge,{isOpen:s,confirmHandler:d,cancelHandler:j,children:[e.jsx("h3",{className:"my-8 font-bold text-2xl text-amber-500",children:"Are you sure?"}),e.jsx("p",{className:"mb-12",children:"This action is irreversible."})]})]})};export{Me as default};
