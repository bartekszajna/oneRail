import{j as e,r as j,A as x}from"./index-Wq9lmydX.js";import{u as v}from"./useQuery-C1Y5_mJl.js";import{u as m,c as S,z as l,S as w,B as I,a as N,b as F,T as p}from"./zod-C_zB2a-s.js";import{c as k}from"./createLucideIcon-JPqlrOpP.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],R=k("trash",C);function T({name:t,control:a,...i}){const{field:n,fieldState:s}=m({name:t,control:a});return e.jsx(S,{...n,className:"resize-none",...i,error:s.error?.message})}function A(t){try{return new URL(t),!0}catch{return!1}}const P=l.object({title:l.string().min(1,{error:"Field cannot be empty"}),description:l.string().min(1,{error:"Field cannot be empty"}),price:l.coerce.number().int().min(1).max(9999),categoryId:l.number().int().min(1),images:l.array(l.string()).superRefine((t,a)=>{(t.filter(n=>!A(n)).length>0||!t.length)&&a.addIssue({code:"custom",message:"One or more valid URLs is required",path:[]})})});function E({name:t,options:a,control:i,...n}){const{field:s,fieldState:o}=m({name:t,control:i});return e.jsx(w,{options:a,...s,...n,error:o.error?.message})}function L({name:t,label:a,control:i,...n}){const[s,o]=j.useState(""),{field:{value:c,onChange:d,...u},fieldState:g}=m({name:t,control:i}),f=()=>{const r=s.trim();r&&!c.includes(r)&&(d([...c,r]),o(""))},h=r=>{d(c.filter(y=>y!==r))},b=r=>{r.key==="Enter"&&(r.preventDefault(),f())};return e.jsxs("div",{children:[e.jsx(I,{...n,...u,value:s,onChange:r=>o(r.target.value),onKeyDown:b,label:a,error:g.error?.message}),e.jsx("h4",{children:"URLs list:"}),e.jsx("ul",{className:"mt-2",children:c?.map(r=>e.jsxs("li",{className:"w-full flex text-sm bg-[var(--light-bg)] rounded-full px-3 py-2 items-center justify-between gap-4 mb-4",children:[e.jsx("span",{className:"w-full truncate",children:r}),e.jsx("button",{type:"button",className:"hover:cursor-pointer hover:text-amber-500 ",onClick:()=>h(r),children:e.jsx(R,{className:"size-4"})})]},r))})]})}const U=({product:t,categories:a})=>{const{handleSubmit:i,setError:n,control:s,formState:{isSubmitting:o}}=N({defaultValues:t?{title:t.title,price:t.price,categoryId:t.categoryId,description:t.description,images:t.images}:void 0,resolver:F(P)}),c=async d=>{(await fetch(x+"/products",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)})).ok||n("root",{message:"You could not be authorized"})};return e.jsxs("form",{className:"w-[80%] mx-auto md:w-[600px] bg-[var(--dark-bg)] backdrop-blur-xs flex flex-col gap-2 sm:gap-6 px-8 py-8 sm:px-12 rounded-2xl shadow-xl items-stretch",onSubmit:i(c),children:[e.jsx(p,{label:"Title",name:"title",control:s}),e.jsx(p,{label:"Price",name:"price",control:s}),e.jsx(T,{label:"Description",name:"description",control:s,rows:5}),e.jsx(E,{label:"Category",name:"categoryId",control:s,options:a}),e.jsx(L,{label:"Images",name:"images",control:s}),e.jsx("button",{type:"submit",disabled:o,className:"px-12 py-3 rounded-4xl bg-gray-300 text-gray-900 font-bold hover:cursor-pointer outline-none focus:bg-amber-500 hover:bg-amber-500 hover:text-gray-100 disabled:opacity-50 disabled:pointer-events-none transition-all active:scale-95",children:o?"Submitting...":"Submit"})]})},_=()=>{const{data:t}=v({queryKey:["categories"],queryFn:async()=>await(await fetch(x+"/categories")).json()});return e.jsxs("div",{className:"flex flex-col gap-8 justify-center items-center mb-20",children:[e.jsx("h1",{children:"Create new product"}),e.jsx(U,{categories:t})]})};export{_ as default};
